<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>公的支援制度・活用診断 チェックシート - 診断結果</title>
    <meta name="description" content="公的支援制度・活用診断 チェックシートは、公的支援制度（補助金・助成金・融資）活用支援サービスです。中小企業の経営者を徹底的に応援します。">
    <meta name="keywords" content="補助金,助成金,診断,コロナ">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="公的支援制度・活用診断 チェックシート - 診断結果">
    <meta property="og:description" content="公的支援制度・活用診断 チェックシートは、公的支援制度（補助金・助成金・融資）活用支援サービスです。中小企業の経営者を徹底的に応援します。">
    <meta property="og:url" content="https://shindan.jmatch.jp">
    <meta property="og:image" content="https://shindan.jmatch.jp/writeup/assets/images/fb.png">
    <link rel="shortcut icon" href="https://shindan.jmatch.jp/writeup/assets/images/favicon.ico">
    
    <!-- CSVパーサーを追加 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    
    <style>
        body {
            font-family: 'Hiragino Kaku Gothic Pro', 'ヒラギノ角ゴ Pro W3', Meiryo, メイリオ, Osaka, 'MS PGothic', sans-serif;
            line-height: 1.7;
            color: #333;
            background-color: #f8f8f8;
            margin: 0;
            padding: 0;
        }
        
        .header {
            background: #ff0000;
            color: white;
            padding: 10px 0;
        }
        
        .header-inner {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header-inner__btn > div {
            background: #db1d1d;
            color: #ffffff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .main-heading {
            text-align: center;
            padding: 30px 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .second-title {
            font-size: 28px;
            margin-bottom: 30px;
        }
        
        .all-price {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .price {
            margin: 20px 0;
        }
        
        .price-border {
            font-size: 48px;
            font-weight: bold;
            color: #ff0000;
            display: inline-block;
            padding: 0 20px;
            position: relative;
        }
        
        .price-border:after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: #ff0000;
        }
        
        .second-txt {
            font-size: 14px;
            margin: 20px 0;
        }
        
        .second-case {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .second-case-title {
            color: #ff0000;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .subsidy-btn {
            text-align: center;
            margin: 30px 0;
        }
        
        .subsidy-copy {
            margin-bottom: 10px;
        }
        
        .subsidy-submit input {
            background: #88e0db;
            border: 1px solid #88e0db;
            box-shadow: 0 4px 0 0 #ff0000;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .page-wrap {
            background: #ff6666;
            padding: 30px 20px;
            position: relative;
        }
        
        .page-heading {
            text-align: center;
            color: white;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .page-txt {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .subsidy {
            max-width: 800px;
            margin: 0 auto;
        }
        
        article {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .article-img {
            width: 100%;
            height: 200px;
            overflow: hidden;
            background: #eee;
            position: relative;
        }
        
        .article-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .article-block {
            padding: 20px;
        }
        
        .subsidy-title {
            font-size: 22px;
            margin-bottom: 10px;
        }
        
        .subsidy-end-txt span {
            color: #ff0000;
            font-weight: bold;
        }
        
        .subsidy-url a {
            color: #ff0000;
            text-decoration: none;
        }
        
        .subsidy-txt {
            margin: 15px 0;
        }
        
        .subsidy-term p {
            background: #88e0db;
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
        }
        
        .subsidy-price {
            font-size: 20px;
            font-weight: bold;
        }
        
        .subsidy-price span {
            color: #ff0000;
            font-size: 24px;
        }
        
        .page-title {
            background: #ff0000;
            padding: 20px;
            text-align: center;
        }
        
        .page-title__heading {
            color: white;
            font-size: 24px;
            margin: 0;
        }
        
        .accordion-faq {
            margin-bottom: 15px;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .accordion-faq .dt {
            background: #ff0000;
            color: white;
            padding: 15px;
            cursor: pointer;
            position: relative;
        }
        
        .accordion-faq .dt span {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .accordion-faq .dd {
            padding: 15px;
            background: white;
            display: none;
        }
        
        footer {
            background: #333;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .footer-logo {
            margin-bottom: 15px;
        }
        
        .copy {
            font-size: 12px;
        }
        
        @media screen and (min-width:768px) {
            .subsidy-btn input[type="submit"]:hover {
                background: #ff0000;
            }
            
            .header-inner__btn > div:hover {
                background: #88e0db;
            }
        }
        
        .no-results {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body class="style_1681">
<header class="header">
    <div class="header-inner">
        <div class="header-inner__logo">
            <a href="index.html">
                <h2 style="color: white; padding: 10px; margin: 0;">補助金診断システム</h2>
            </a>
        </div>
        <div class="header-inner__btn"><div class="js-scroll" href="#next">申請の相談をする</div></div>
    </div>
</header>
<main>
    <form id="form" name="finp" action="index.html" method="get">
        <!-- 以前の隠しフィールドは簡略化 -->
        <input type="hidden" name="reset" value="1">
        
    <section class="main-heading">
        <h1 class="second-title">診断結果</h1>
        
        <div class="all-price">
            最大受給金額は・・・
        </div>
        <div class="price">
            <div class="price-border"><span id="max-subsidy-amount">計算中...</span>万円</div>
        </div>
        
        <div class="all-price">
            <div class="all-price__inner"></div>
        </div>
        <p class="second-txt">独自の算定基準に基づき試算した<br class="sp">期待金額を表示しています</p>
            
        <div class="second-case">
            <div class="second-case-title">例えば、このような経費が<br class="sp">補助対象になっています（2025年度実績）</div>
            <h1>社用車、パソコン、研修、内装工事、ホームページ・ECサイト、システム開発、AI開発など</h1>
            <p>他にも様々な経費が補助金対象になっています。<br>補助金を活用し、負担を減らしながら事業を成長させられる可能性があります。</p>
        </div>
        
        <div id="next" class="subsidy-btn">
            <div class="subsidy-copy">まずは無料で、お気軽に</div>
            <div class="subsidy-submit is-reflection">
                <input type="submit" value="もう一度診断する" class="ls_btn">
            </div>
        </div>

        <div class="second-txt" style="margin-top: 10px;"></div>
        
    </section>

    <section class="page-wrap">
        <h2 class="page-heading">主要な該当する補助金・助成金</h2>
        <p class="page-txt">診断結果から受給可能な制度をご紹介いたします。<br><br>
詳細は各制度の公式サイトをご確認ください。</p>

        <div id="next" class="subsidy-btn">
            <div class="subsidy-copy">まずは無料で、お気軽に</div>
            <div class="subsidy-submit is-reflection">
                <input type="submit" value="もう一度診断する" class="ls_btn">
            </div>
        </div>

        <section class="subsidy" id="subsidy-container">
            <!-- ここにJavaScriptでCSVから読み込んだ補助金情報が挿入されます -->
            <div class="loading">読み込み中...</div>
        </section>

        <div id="next" class="subsidy-btn">
            <div class="subsidy-copy">まずは無料で、お気軽に</div>
            <div class="subsidy-submit is-reflection">
                <input type="submit" value="もう一度診断する" class="ls_btn">
            </div>
        </div>
    </section>

<section id="block-id">
    <div class="block-id__4">
        <section class="page-title">
            <h1 class="page-title__heading">よくあるご質問</h1>
        </section>
        <section class="page-wrap">
            <h2 class="page-heading"></h2>
            <p class="page-txt"></p>

            <div class="accordion-faq">
                <div class="dt"><span>Q.</span>受給までどれくらいかかりますか？</div>
                <div class="dd">制度の種類にもよりますが、多くの場合、<br>
申請から受給までに「１年～１年半程」となることが多いです。</div>
            </div>
            <div class="accordion-faq">
                <div class="dt"><span>Q.</span>申請できる法人形態のルールはありますか</div>
                <div class="dd">〈補助金〉<br>
制度の種類にもよりますが、社団法人や医療法人などの一部の非営利法人や<br>
みなし大企業は対象外となります。<br>
<br>
〈助成金〉<br>
業種・業態にかかわらず「受給条件」を満たしている事業主さまであれば原則申請可能です。<br>
ただし、風俗・暴力団関係などは対象外となります。<br>
<br>
※制度の種類や公募ごとに条件が変更する可能性があるため、詳細は各公式サイトでご確認ください。</div>
            </div>
            <div class="accordion-faq">
                <div class="dt"><span>Q.</span>受給条件は何ですか？</div>
                <div class="dd">制度の種類にもよりますが、主な受給条件は下記になります。<br>
<br>
〈補助金〉<br>
・中小企業（個人事業主も含む）<br>
・何か新しい事を行う<br>
　ー設備投資を中心に経費が補助されます<br>
<br>
〈助成金〉<br>
・雇用保険加入者を1名以上雇用している（経営者本人、取締役、親族を除く）<br>
・全従業員が保険の加入義務に違反していない<br>
・会社都合解雇を半年以内にしていない<br>
・残業代未払等、労務違反を犯していない<br>
<br>
※制度の種類や公募ごとに条件が変更する可能性があるため、各公式サイトでご確認ください。</div>
            </div>
            <div class="accordion-faq">
                <div class="dt"><span>Q.</span>「補助金」と「助成金」の違いは何ですか？</div>
                <div class="dd">補助金と助成金の最大の違いは、金額と支給方法になります。<br>
<br>
〈金額〉<br>
補助金：金額が大きく、受け取るのに「採択」（合格）という概念があり、<br>
合格すれば受け取る事ができる<br>
助成金：労務違反等がなければ、申請するとほぼ100%受け取れる<br>
<br>
〈支給方法〉<br>
補助金：使った額の一部が補助される<br>
助成金：定額型で、最初から決まった額を受給できる</div>
            </div>
        </section>
    </div>
</section>
</form>

</main>
<footer>
    <div class="footer-logo">
        <h3>補助金診断システム</h3>
    </div>
    <p class="copy">© 2025 補助金診断システム All Rights Reserved</p>
</footer>

<!-- 補助金データパーサースクリプト -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // アコーディオン機能の初期化
    const accordionItems = document.querySelectorAll('.accordion-faq .dt');
    accordionItems.forEach(item => {
        item.addEventListener('click', function() {
            const content = this.nextElementSibling;
            if (content.style.display === 'block') {
                content.style.display = 'none';
            } else {
                content.style.display = 'block';
            }
        });
    });

    // URLパラメータを解析する関数
    function parseUrlParams() {
        const params = {};
        const queryString = window.location.search;
        if (!queryString) return params;
        
        const pairs = queryString.slice(1).split('&');
        for (const pair of pairs) {
            const [key, value] = pair.split('=');
            if (key && value) {
                try {
                    params[decodeURIComponent(key)] = decodeURIComponent(value);
                } catch (e) {
                    // デコードエラーの場合はそのまま使用
                    params[key] = value;
                }
            }
        }
        return params;
    }

    // 選択された項目の値を取得する関数
    function getSelectedItems(params) {
        const selectedItems = [];
        
        // フォームの値を取得 (MAIL[q*]パラメータ)
        for (const key in params) {
            if (key.startsWith('MAIL%5Bq') || key.startsWith('MAIL[q') || 
                key.startsWith('MAIL%5BQUESTION_') || key.startsWith('MAIL[QUESTION_')) {
                try {
                    selectedItems.push(decodeURIComponent(params[key]));
                } catch (e) {
                    // デコードエラーの場合はそのまま追加
                    selectedItems.push(params[key]);
                }
            }
        }
        
        return selectedItems;
    }

    // CSVファイルから補助金データを解析する関数
    async function parseSubsidyData() {
        try {
            // ローディング表示
            const maxAmountElement = document.getElementById('max-subsidy-amount');
            const subsidyContainer = document.getElementById('subsidy-container');
            
            // URLパラメータから選択された項目を取得
            const urlParams = parseUrlParams();
            const selectedItems = getSelectedItems(urlParams);
            
            console.log("選択された項目:", selectedItems);
            
            // CSVファイルを読み込む (Fetch APIを使用)
            const response = await fetch('fixed_subsidy_results.csv');
            const csvText = await response.text();
            
            // CSVをパース
            const parsedData = Papa.parse(csvText, {
                header: true,
                skipEmptyLines: true
            });
            
            console.log("CSVデータ読み込み完了:", parsedData.data.length, "件");
            
            // 選択した項目に基づいて補助金をフィルタリング
            const filteredSubsidies = parsedData.data.filter(subsidy => {
                // 「選択した項目」列が空の場合は常に表示
                if (!subsidy['選択した項目']) return true;
                
                // 選択した項目と補助金の適用条件をマッチング
                const subsidyItems = subsidy['選択した項目'].split(/,\s*/);
                
                // 少なくとも1つの選択項目がマッチすればOK
                return subsidyItems.some(item => 
                    selectedItems.some(selected => 
                        selected === item || item.includes(selected)
                    )
                );
            });
            
            console.log("フィルタリング後の補助金:", filteredSubsidies.length, "件");
            
            // 各補助金の最大金額を計算
            let totalMaxAmount = 0;
            const eligibleSubsidies = [];
            
            for (const subsidy of filteredSubsidies) {
                // 金額から数値を抽出
                const amountText = subsidy['金額'] || '';
                const numberMatches = amountText.match(/(\d+(?:,\d+)*)/g);
                let maxAmount = 0;
                
                if (numberMatches) {
                    // 複数の数値がある場合は最大値を取得（カンマを除去して整数に変換）
                    const numbers = numberMatches.map(numStr => parseInt(numStr.replace(/,/g, ''), 10));
                    maxAmount = Math.max(...numbers);
                }
                
                // 有効な金額がある場合のみ追加
                if (maxAmount > 0) {
                    totalMaxAmount += maxAmount;
                    
                    // 補助金情報を整形
                    eligibleSubsidies.push({
                        title: subsidy['タイトル'] || '',
                        status: subsidy['ステータス'] || '',
                        url: subsidy['URL'] || '',
                        description: subsidy['説明'] || '',
                        period: subsidy['期間'] || '',
                        amount: subsidy['金額'] || ''
                    });
                }
            }
            
            // 合計金額の表示（抑え目の金額に調整：合計の約30%）
            // 最低でも500万円は表示
            const displayAmount = Math.max(500, Math.round(totalMaxAmount * 0.3));
            maxAmountElement.textContent = displayAmount.toLocaleString();
            
            // 補助金リストをHTMLに表示
            if (subsidyContainer) {
                // ローディング表示を削除
                subsidyContainer.innerHTML = '';
                
                if (eligibleSubsidies.length > 0) {
                    // 各補助金カードを作成
                    eligibleSubsidies.forEach((subsidy, index) => {
                        const article = document.createElement('article');
                        
                        const imgBlock = document.createElement('div');
                        imgBlock.className = 'article-img';
                        // 画像のシード値として補助金名を使用（同じ補助金には同じ画像を表示）
                        const seed = subsidy.title.length * (index + 1);
                        imgBlock.innerHTML = `<img src="https://picsum.photos/seed/${seed}/400/200" alt="${subsidy.title}">`;
                        
                        const contentBlock = document.createElement('div');
                        contentBlock.className = 'article-block';
                        
                        // 補助金情報を生成
                        const title = document.createElement('h3');
                        title.className = 'subsidy-title';
                        title.textContent = subsidy.title;
                        
                        let statusHTML = '';
                        if (subsidy.status && subsidy.status !== '公募中') {
                            statusHTML = `<div class="subsidy-end-txt"><span>${subsidy.status}</span></div>`;
                        }
                        
                        const urlHTML = subsidy.url ? 
                            `<div class="subsidy-url"><a href="${subsidy.url}" target="_blank">詳細ページ</a></div>` : '';
                        
                        const descHTML = subsidy.description ? 
                            `<div class="subsidy-txt">${subsidy.description}</div>` : '';
                        
                        const periodHTML = subsidy.period && subsidy.period !== '期間情報なし' ? 
                            `<div class="subsidy-term"><p>${subsidy.period}</p></div>` : '';
                        
                        const amountHTML = subsidy.amount ? 
                            `<div class="subsidy-price">金額: <span>${subsidy.amount}</span></div>` : '';
                        
                        // HTMLを構築
                        contentBlock.innerHTML = `
                            ${title.outerHTML}
                            ${statusHTML}
                            ${urlHTML}
                            ${descHTML}
                            ${periodHTML}
                            ${amountHTML}
                        `;
                        
                        article.appendChild(imgBlock);
                        article.appendChild(contentBlock);
                        subsidyContainer.appendChild(article);
                    });
                } else {
                    // 該当する補助金がない場合のメッセージ
                    subsidyContainer.innerHTML = `
                        <div class="no-results">
                            <h3>該当する補助金が見つかりませんでした</h3>
                            <p>選択した条件に合致する補助金・助成金はありませんでした。<br>
                            条件を変更して、もう一度お試しください。</p>
                        </div>
                    `;
                }
            }
        } catch (error) {
            console.error('データの解析に失敗しました:', error);
            document.getElementById('max-subsidy-amount').textContent = '計算エラー';
            document.getElementById('subsidy-container').innerHTML = `
                <div class="no-results">
                    <h3>エラーが発生しました</h3>
                    <p>データの読み込みに失敗しました。<br>
                    もう一度お試しいただくか、管理者にお問い合わせください。</p>
                </div>
            `;
        }
    }
    
    // 補助金データを解析して表示
    parseSubsidyData();
});
</script>
</body>
</html>